icon = "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAtNQTFRFAAAAICMoHyMnHiEmIiUkHyIoICQoISMnICMnHB8mICInICMqHyInICMoICMoICMoICMoICMoICMoICMoHyMnICMoICMoICMoICMoICMoICIoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoICMoHyMnHyInICMoICMoICMoICMoHyMoICMoICMoICMoICMoICMoHyIoICMoICMoICMoICMoICMoICMoICMoICMoICMoICInICMoHyMoICMoICMoHyInHSAlLC80LC4zMDI3dXZ6yMnKx8jJdXd6MTQ5eXp9zc3O+vr7////zc7Pent+MTQ4HiEmNTc8foCDz9DR+/v7zs/QMzY6ODs/goSH09TV/Pz80dLTNzo+T1JW0tLT/v7+xsfIPkBFLjE1bnB0wMHC+fn58PDxra+wXmBkJikuHB8lKy4zamxvvr/A9/f47u/vqqutVlhcJCcrGx4kKiwxZ2ltvb6/9vf36erqoaKkUVNXIyYrHB8kHiInMjU5Gx4jKSwwZGZqvLy+9fX15ubmmpyeSk1RISQpMzU6LzI2OjxBkZKV1tbX1dXWhoiLOTxAKSwxVVdbREZLQURIk5SX19jZ0dHSg4WHLTA1RklNuru89/f3/f392trbh4mLQ0ZKlZaZ4OHh8PDwpKWnKCswX2Fltba49PT02tvciIqMPD5DRUdLl5ia4+Pk5+jonp+iT1FVJykuXV9jsrO08vPz3+Dg5ebmmJmcSEpOJSgtWlxgrrCx8fHx4ODhkJGUREdLHSEmHSAmJCcsWFpenZ+hQENHSUxQiYuNPkFFTlFV1dbX4uPjlpiaREZKTE5SnqCiODtA7+/w4+Tkl5iboqOl6enq5OTllZeZU1VZp6iqnp+h6+vs3d7fjY+RIyYqUVRYo6Wn7e3uiYqNPUBEIiUqUFNWoKKk6OnpgoSGNTg8HIa7LAAAAEV0Uk5TAAAAAAAAAAAAAAAAAAMqcq3V9PMDOZjf/DgDG4rqGTbC/r8yRtnWQ9jBwAICOukCkwIr3mylawKGGr4z1Nc/NTEDNwOmJvfrmAAAAAFiS0dEU3pnHQYAAAAJcEhZcwAACxMAAAsTAQCanBgAAAKHSURBVDjLY2CAAkZePn4BQSFXV2FBAX4+XkYGVMAkIiomLuEKBRLiYpJSyEqYGaVlZF1RgKyMHCMLTJ6VTV7BFR0oKikzskPlGVVU4eJubnCmmjojB8R8eQ24tLuHpztciZo8IyfI+dKacGkvbx9fPy+4Ei1poEsZtWVg0v4BgUHBwUEhoWEwJTI6XAyMumD3h7tHREZFB4NBdExkLESJniQjg74YWG1cfEJiMBwkJsUng4UNDBmMxEH6U1LTglFAWnpGOFDC2IiBHxR+bplZ2TnI8rl5+QXgMDVhEIC4sLCouKQUJl1WXlHpDnGmKYMg1EvhVdU1tXUg6fqGxqZmmE8FGYTBdEt4q797W3tHZ1d3T29fm1v/hHCIEmEGiA0TJ02eMnWae9v0GTNd28JnzZ4zd958iAqIgvAFCxcFL16ydKJ7W7PbsuUrgoNXroqAKoBYEb56zdp1wYvXb9i4afOW4OCt27Y3wawQhAX0jp27dgcv3rM3OHjvvv2u7nBHCkA9Ee7eduDgocPBaUeOHnOrOn4iHOZNcEC5Ni04enRZeNvJU6c3nAlvcz07+9z5PnBAmUGD+sLF4OBLl6+4tbm5V7levbY1OC37uhskqCGRVVBRfiM4+OatY25922/fCQ6+e29/EziyzBkYRfVALPem+w/KgBIPHzwKTnv85IpbOCy6GfWhCcb96bPnL4AhvXjJy1fhUCda6IOSlKUS1Evur9+8fZfwfhpM2tXKEpQ5uBmt1VzhSmZ+cIdJu9ooM3KDkjUHo7otPK2HI5K9jR0jKyRjsDPaa7qiA0UrB0YeWNZiwcx6ehZyEPOhgMtR0gA58xo4YeRvRmcjExdI9ncxM0JIAwBddigjPGjDmQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMy0zMFQxMzowMzoxMSswMjowMORKSbgAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDMtMzBUMTM6MDM6MTErMDI6MDCVF/EEAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTYtMDYtMTYgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn5r80tgAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQANTEywNBQUQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAA1MTIcfAPcAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE0OTA4NzE3OTF28+iMAAAAE3RFWHRUaHVtYjo6U2l6ZQAyOS40S0JCC+gWuwAAAFB0RVh0VGh1bWI6OlVSSQBmaWxlOi8vLi91cGxvYWRzL2Nhcmxvc3ByZXZpL3NZcDlhM3kvMTE5NS8xNDkwODg5NjQ2LWJ1ZmZlcl84MjUyMy5wbmf+f3XHAAAAAElFTkSuQmCC"
from tkinter import *
from bufeer import Buff
import time
from keyboard import on_release_key, send, write, wait, remove_hotkey, add_hotkey, remap_hotkey, unhook_all_hotkeys
#pyinstaller -F -w -i="buff.ico" -n="SmartBuffertest" --collect-all pynput main.py
class App():

    def __init__(self):
        self.windows = Tk()
        self.windows.title("SmartBuffer")
        self.windows.resizable(0, 0)
        self.windows.tk.call("wm", "iconphoto", self.windows._w, PhotoImage(data=icon))

        self.reBtnBuff1 = "q+w+e+r"
        self.reBtnBuff2 = "q+w+e+r"

        self.listHot = [[self.reBtnBuff1,self.readBuff1], [self.reBtnBuff2,self.readBuff2]]

        self.build()
        self.smart = Buff()

        self.windows.minsize(250,380)
        self.windows.mainloop()

    def readBuff2(self):
        send("ctrl + c")
        time.sleep(.05)
        buff = self.windows.clipboard_get()
        print("Buff2", buff)
        self.smart.buff0 = buff
        self.lblBuff1.configure(text = "Буфер №1\n"+buff)

    def readBuff1(self):
        send("ctrl + c")
        time.sleep(.05)
        buff = self.windows.clipboard_get()
        print("Buff2", buff)
        self.smart.buff1 = buff
        self.lblBuff2.configure(text = "Буфер №2\n"+buff)

    def AddHot(self):
        №print(self.listHot)
        print("Запуск скрипта2")

        for i in self.listHot:
            add_hotkey(i[0], i[-1])

    def start(self):
        self.smart.AddHotKey()
        self.AddHot()
        self.smart.RemapHotKey(hotkey = self.past, hotkey2 = self.copy)
        remap_hotkey("shift+"+self.copy, 'ctrl+{}'.format("shift+"+self.copy))
        remap_hotkey("shift+"+self.past, 'ctrl+{}'.format("shift+"+self.past))
        self.lblApp.configure(text = "Работает")
        print("start")

    def stop(self):
        self.smart.RemoveHotKey()
        self.lblApp.configure(text = "Не работает")
        print("stop")

    def acceptBuff3(self):
        buff3 = self.entBuff3.get()
        buff3K = self.entBuff3k.get()
        try:
            whait = float(self.entWhait.get())
        except:
            whait = 0.5

        self.smart.RemapHotKey(hotkey4 = buff3K)
        self.smart.buff2 = buff3
        self.smart.whait = whait
        self.lblBuff3.configure(text = 'Буфер №3\n{}'.format(buff3))
        self.lblWhait.configure(text = 'Сек: {}'.format(whait))
        self.lblBuff3Hot.configure(text = buff3K)

    def updateBuff3(self):
        buff3 = self.entBuff3.get()
        self.smart.buff2 = buff3
        self.lblBuff3.configure(text = 'Буфер №3\n{}'.format(buff3))


    def acceptBuff(self):
        self.copy =  self.entCopy.get()
        self.past =  self.entPast.get()
        buff1 = self.entBuff1.get()
        buff2 = self.entBuff2.get()

        self.smart.buff0 = buff1
        self.smart.buff1 = buff2

        if self.copy == "" or self.copy == "q+w+e+r":
            self.copy = "q+w+e+r"
        else:
            self.listHot[0][0] = "shift+"+self.copy
            self.lblPast.configure(text = self.past)

        if self.past == "" or self.copy == "q+w+e+r":
            self.past = "q+w+e+r"
        else:
            self.listHot[1][0] = "shift+"+self.past
            self.lblCopy.configure(text = self.copy)


        self.lblBuff1.configure(text = "Буфер №1\n"+buff1)
        self.lblBuff2.configure(text = "Буфер №2\n"+buff2)
        print("acceptBuff")

    def acceptMouse(self):
        mouse = self.entMouse.get()
        self.smart.RemapHotKey(hotkey3 = mouse)
        self.lblMousHot.configure(text = mouse)
        print("acceptMouse")

    def mouseCordinats(self):
        print("mouseCordinats")
        self.smart.Mouse()
        self.lblMouseCord.configure(text = "Cord {} : {}".format(self.smart.x, self.smart.y))


    def build(self):
        window = Frame(self.windows, borderwidth = 11)
        window.grid(row = 1, column = 1, padx = 5, pady = 5)

        self.lblBuff1 = Label(window, text = 'Буфер №1\nNone')
        self.entBuff1 = Entry(window)
        self.lblBuff2 = Label(window, text = 'Буфер №2\nNone')
        self.entBuff2 = Entry(window)

        self.lblPastEnt = Label(window, text = "Быстрый ввод №1", anchor = 'w')
        self.entPast = Entry(window)
        self.lblPast = Label(window, text = " ")

        self.lblCopyEnt = Label(window, text = "Быстрый ввод №2", anchor = 'w')
        self.entCopy = Entry(window)
        self.lblCopy = Label(window, text = " ")

        self.btnAceptBuff = Button(window, text = "Приниять", command = self.acceptBuff)

        self.frmMid = Frame(window)

        self.btnMouseCord = Button(window, text = "Задать кординаты", command = self.mouseCordinats)
        self.lblMouseCord = Label(window, text = "Cord 0 : 0", width = 12, anchor = "center")

        self.lblMouse = Label(window, text = "Нажатие", anchor = 'w')
        self.entMouse = Entry(window)
        self.lblMousHot = Label(window, text = " ")

        self.btnAceptMouse = Button(window, text = "Принять", command = self.acceptMouse)

        self.frmMid2 = Frame(window)

        self.lblBuff3 = Label(window, text = 'Буфер №3\nNone')
        self.entBuff3 = Entry(window)
        self.btnBuff3 = Button(window, text = "Обновить", command = self.updateBuff3)

        self.lblBuff3k = Label(window, text = "Быстрый ввод №3", anchor = 'w')
        self.entBuff3k = Entry(window)
        self.lblBuff3Hot = Label(window, text = " ")
        self.entWhait = Entry(window)
        self.lblWhait = Label(window, text = "Сек: 0.5")
        self.btnAceptBuff3 = Button(window, text = "Принять", command = self.acceptBuff3)

        self.frmMid3 = Frame(window)

        self.btnAppStart = Button(window, text = "Старт", command = self.start)
        self.btnAppStop = Button(window, text = "Стоп", command = self.stop)
        self.lblApp = Label(window, text = "Не работает")



        self.lblBuff1.grid(row = 1, column = 1, pady=1, padx=1, sticky="nsew")
        self.entBuff1.grid(row = 2, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblBuff2.grid(row = 1, column = 2, pady=1, padx=1, sticky="nsew")
        self.entBuff2.grid(row = 2, column = 2, pady=1, padx=1, sticky="nsew")

        self.lblPastEnt.grid(row = 3, column = 1, pady=1, padx=1, sticky="nsew")
        self.entPast.grid(row = 4, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblPast.grid(row = 5, column = 1, pady=1, padx=1, sticky="nsew")

        self.lblCopyEnt.grid(row = 3, column = 2, pady=1, padx=1, sticky="nsew")
        self.entCopy.grid(row = 4, column = 2, pady=1, padx=1, sticky="nsew")
        self.lblCopy.grid(row = 5, column = 2, pady=1, padx=1, sticky="nsew")

        self.btnAceptBuff.grid(row = 7, column = 1, columnspan = 2, pady=1, padx=1, sticky="nsew")

        self.frmMid.grid(row = 8, column = 1, pady=15, padx=0, sticky="nsew")

        l = 9
        self.btnMouseCord.grid(row = 9+l, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblMouseCord.grid(row = 9+l, column = 2, pady=1, padx=1, sticky="nsew")

        self.lblMouse.grid(row = 10+l, column = 1, pady=1, padx=1, sticky="nsew")
        self.entMouse.grid(row = 11+l, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblMousHot.grid(row = 11+l, column = 2, pady=1, padx=1, sticky="nsew")

        self.btnAceptMouse.grid(row = 12+l, column = 1, pady=1, padx=1, sticky="nsew")

        self.frmMid2.grid(row = 17, column = 1, pady=15, padx=0, sticky="nsew")

        l1 = -4
        self.lblBuff3.grid(row = 14+l1, column = 1, columnspan = 2, pady=1, padx=1, sticky="nsew")
        self.entBuff3.grid(row = 15+l1, column = 1, columnspan = 2, pady=1, padx=1, sticky="nsew")
        self.btnBuff3.grid(row = 16+l1, column = 1, columnspan = 2, pady=1, padx=1, sticky="nsew")

        self.lblBuff3k.grid(row = 17+l1, column = 1, pady=1, padx=1, sticky="nsew")
        self.entBuff3k.grid(row = 18+l1, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblBuff3Hot.grid(row = 18+l1, column = 2, pady=1, padx=1, sticky="nsew")
        self.entWhait.grid(row = 19+l1, column = 1, pady=1, padx=1, sticky="nsew")
        self.lblWhait.grid(row = 19+l1, column = 2, pady=1, padx=1, sticky="nsew")
        self.btnAceptBuff3.grid(row = 20+l1, column = 1, columnspan = 2, pady=1, padx=1, sticky="nsew")

        self.frmMid3.grid(row = 30, column = 1, pady=15, padx=0, sticky="nsew")

        self.btnAppStart.grid(row = 31, column = 1, pady=1, padx=1, columnspan = 2, sticky="nsew")
        self.btnAppStop.grid(row = 32, column = 1, pady=1, padx=1, columnspan = 2, sticky="nsew")
        self.lblApp.grid(row = 33, column = 1, pady=1, padx=1, columnspan = 2, sticky="nsew")

App()
